"use strict";(self.webpackChunkcontrols_visualizer=self.webpackChunkcontrols_visualizer||[]).push([[966],{2505:function(t,e){var s=function(){function t(t,e,s,i,r,n,a,h){this.speed=0,this.phi=0,this.max_steer=.5,this.max_speed=50,this.theta_dot=0,this.loc=h.createVector(t,e),this.vel=h.createVector(1,1),this.theta=s,this.p5=h,this.car_len=r,this.car_wid=this.car_len/2.5,this.tyre_wid=this.car_wid/7,this.tyre_len=this.car_len/6.6,this.color=n,this.car_ref=a,this.phi=i,this.shouldDrawImpossibleRegion=!1}var e=t.prototype;return e.run=function(){this.display(),this.move(),this.car_ref&&(this.car_ref.current={x:this.loc.x,y:this.loc.y,theta:this.theta,phi:this.phi})},e.display=function(){this.p5.push(),this.p5.translate(this.loc.x,this.loc.y),this.p5.rotate(this.theta),this.draw_car_body(),this.draw_front_wheels(),this.p5.pop()},e.draw_car_body=function(){this.shouldDrawImpossibleRegion&&this.drawImpossibleRegion(),this.p5.stroke(0),this.p5.strokeWeight(2),this.p5.fill(this.color);var t=-this.car_len/2,e=-this.car_wid/2;this.p5.rect(t,e,this.car_len,this.car_wid,10),this.p5.fill(0),this.p5.noStroke();var s=-this.car_len/2+this.tyre_len/3,i=-this.car_wid/2+.5*this.tyre_wid,r=this.car_wid/2-1.5*this.tyre_wid;this.p5.rect(s,i,this.tyre_len,this.tyre_wid,5),this.p5.rect(s,r,this.tyre_len,this.tyre_wid,5)},e.draw_front_wheels=function(){this.p5.noStroke(),this.p5.fill(0);var t=this.car_len/2-this.tyre_len/2-this.tyre_len/3,e=-this.car_wid/2+this.tyre_wid,s=this.car_wid/2-this.tyre_wid;this.p5.push(),this.p5.translate(t,e),this.p5.rotate(this.phi),this.p5.rect(-this.tyre_len/2,-this.tyre_wid/2,this.tyre_len,this.tyre_wid,5),this.p5.pop(),this.p5.push(),this.p5.translate(t,s),this.p5.rotate(this.phi),this.p5.rect(-this.tyre_len/2,-this.tyre_wid/2,this.tyre_len,this.tyre_wid,5),this.p5.pop(),this.p5.push(),this.p5.stroke(220),this.p5.strokeWeight(1),this.p5.fill(180),this.p5.rotate(-this.p5.PI/2),this.p5.line(0,0,0,this.car_len/2),this.p5.translate(0,this.car_len/2),this.p5.triangle(-5,0,0,5,5,0),this.p5.pop()},e.steer=function(t){t>this.max_steer?this.phi=this.max_steer:t<-this.max_steer?this.phi=-this.max_steer:this.phi=t},e.setSpeed=function(t){t>this.max_speed?this.speed=this.max_speed:t<-this.max_speed?this.speed=-this.max_spee:this.speed=t},e.move=function(){this.vel.x=this.speed*Math.cos(this.theta),this.vel.y=this.speed*Math.sin(this.theta),this.theta_dot=this.speed*Math.tan(this.phi)/this.car_len,this.theta+=this.theta_dot,this.loc.add(this.vel)},e.dont_crash=function(){this.loc.x<2*-this.car_len&&(this.loc.x=0,this.speed=0),this.loc.x>800&&(this.loc.x=600,this.speed=0),this.loc.y<-50&&(this.loc.y=0,this.speed=0),this.loc.y>700&&(this.loc.y=600,this.speed=0)},e.track=function(t,e,s){null!=s&&null!=s||(s=10);for(var i=0;i<20;i++){var r=t-this.loc.x,n=e-this.loc.y,a=this.p5.createVector(this.p5.cos(this.theta),this.p5.sin(this.theta)),h=this.p5.createVector(r,n).normalize(),c=a.angleBetween(h);this.phi=c>0?this.max_steer:c<0?-this.max_steer:0,this.speed=.1,this.move()}},e.drawImpossibleRegion=function(){this.p5.noFill(),this.p5.stroke("red");var t=this.car_len/this.p5.tan(this.max_steer);this.p5.circle(0,t,2*t),this.p5.circle(0,-t,2*t)},e.getCarState=function(){return{x:this.loc.x,y:this.loc.y,theta:this.theta}},t}();e.Z=s},4840:function(t,e,s){s.r(e),s.d(e,{default:function(){return x}});var i=s(7294),r=s(5861),n=s(7757),a=s.n(n),h=s(2318),c=s.n(h),o=s(5763),l=s.n(o),p=s(6633),u=s.n(p),d=s(9547),f=s(5785),y=s(2505);function m(t,e,s,i){return function(r){var n=e.canvasWidth,a=e.canvasHeight,h=(r.color(0,255,0),r.color(0,50,255),r.color(255,50,10),new y.Z(i.current.x,i.current.y,i.current.theta,i.current.phi,e.carLength,e.carColor,i,r));h.setSpeed(0);var c=0;function o(){var t={x:r.mouseX,y:r.mouseY,index:e.waypoints.length+1};s((function(s){return Object.assign({},s,{waypoints:[].concat((0,f.Z)(e.waypoints),[t])})}))}r.setup=function(){var t=r.createCanvas(n,a);r.background(100),t.mousePressed(o)},r.draw=function(){r.background(100),e.waypoints.forEach((function(t){r.circle(t.x,t.y,.5*e.carLength),r.text(t.index,t.x-.05*e.carLength,t.y-.01*e.carLength)})),e.hasControlInputs&&c<t.controls.length-1?(h.setSpeed(e.carSpeed),h.steer(t.controls[c]),c++,h.run(),c==t.controls.length-1&&(h.setSpeed(0),s((function(t){return Object.assign({},t,{hasControlInputs:!1})})))):h.run()},r.keyPressed=function(){r.keyCode===r.UP_ARROW||"w"===r.key?h.setSpeed(h.speed+1):r.keyCode===r.DOWN_ARROW||"s"===r.key?h.setSpeed(h.speed-1):r.keyCode===r.LEFT_ARROW||"a"===r.key?h.steer(h.phi-.5):r.keyCode===r.RIGHT_ARROW||"d"===r.key?h.steer(h.phi+.5):"t"===r.key&&(h.shouldDrawImpossibleRegion=!h.shouldDrawImpossibleRegion)}}}var _={waypoints:[],controls:[]},g={carLength:70,carSpeed:1,carColor:"#ee6352",waypoints:[],canvasWidth:600,canvasHeight:600,hasControlInputs:!1};var v=function(){var t=(0,i.useState)(_),e=t[0],s=t[1],n=(0,i.useState)(g),h=n[0],o=n[1],p=(0,i.useState)(!1),f=p[0],y=p[1],v=(0,i.useRef)(),x=(0,i.useRef)({x:h.canvasWidth/2,y:h.canvasHeight/2,theta:0,phi:0});function w(){return(w=(0,r.Z)(a().mark((function t(){var e,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!f){t.next=2;break}return t.abrupt("return");case 2:return y(!0),"https://serene-coast-64325.herokuapp.com/bangbang",e=Object.assign({carLength:h.carLength,carSpeed:h.carSpeed,waypoints:h.waypoints},x.current),t.next=7,u().post("https://serene-coast-64325.herokuapp.com/bangbang",e);case 7:i=t.sent,y(!1),s(i.data),o((function(t){return Object.assign({},t,{hasControlInputs:!0})}));case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return(0,i.useEffect)((function(){var t=new(c())(m(e,h,o,x),v.current);return function(){return t.remove()}}),[e,h]),i.createElement("div",{className:"flex flex-col items-center justify-center"},f?i.createElement("div",{className:"flex items-center justify-center space-x-3"},i.createElement("p",null,'"Waiting for backend to deliver results!"'),i.createElement(l(),{type:"spinningBubbles",color:"blue",width:"24px",height:"24px"})):"",i.createElement("div",{ref:v,style:{width:h.canvasWidth,height:h.canvasHeight}}),i.createElement("div",{className:"flex justify-center items-center space-x-3"},i.createElement("button",{className:"bg-blue-300 px-3 py-2 m-3 rounded-md focus:outline-none focus:ring focus:ring-blue-400 hover:ring hover:ring-blue-400 disabled:cursor-not-allowed",onClick:function(){return function(){return w.apply(this,arguments)}()},disabled:f},"Calculate the control inputs!"),i.createElement("button",{className:"bg-red-300 px-3 py-2 m-3 rounded-md focus:outline-none focus:ring focus:ring-red-400 hover:ring hover:ring-red-400",onClick:function(){o(Object.assign({},h,{waypoints:[],hasControlInputs:!1}))}},"Clear Waypoints (X)")),i.createElement("div",{className:"flex flex-col items-center justify-center text-lg"},i.createElement("h1",{className:"text-3xl font-bold"},"Customize your car!"),i.createElement("h3",null,"Set the Length of your car: ",h.carLength),i.createElement(d.Z,{value:h.carLength,setValue:function(t){return o(Object.assign({},h,{carLength:t}))},min:20,max:100,step:1,color:"blue"}),i.createElement("h3",null,"Set the Speed of your car: ",h.carSpeed),i.createElement(d.Z,{value:h.carSpeed,setValue:function(t){return o(Object.assign({},h,{carSpeed:t}))},min:1,max:h.carLength,step:1,color:"green"}),i.createElement("h3",null,"Set the Color of your car"),i.createElement("input",{type:"color",value:h.carColor,onInput:function(t){return o(Object.assign({},h,{carColor:t.target.value}))}})),i.createElement("div",null,JSON.stringify(e)))};var x=function(){return i.createElement("main",null,i.createElement("div",{className:"bg-blue-300 text-6xl flex items-center justify-center py-6 mb-6"}," PID Visualization"),"undefined"!=typeof window&&i.createElement(v,null),i.createElement("div",null,"Hello"))}}}]);
//# sourceMappingURL=component---src-pages-pid-jsx-9240983cc46c89c481a9.js.map